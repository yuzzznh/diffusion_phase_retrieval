# DAPS + ReSample Project Notes

## Environment Setup
- `bash environment.sh` 실행하면 전체 환경 구성됨
- Anaconda + `unified_env.yaml` + `DAPS/requirements.txt` + 추가 패키지 (hydra-core, piq, gdown, imageio-ffmpeg)

## DAPS 실행 시간 분석

### 실행 구조
```
posterior_sample.py
├── num_runs (예: 4) - 같은 실험 반복 횟수
│   └── sample_in_batch()
│       └── for batch in (total_images / batch_size):  # 100장/10 = 10 batches
│           └── sampler.sample()
│               └── for step in annealing_steps (50):  # progress bar
│                   ├── 1. reverse diffusion (2 steps)
│                   ├── 2. MCMC update
│                   └── 3. forward diffusion
```

### Progress Bar 해석
- `50/50 [15:45]` = **1 batch (10장)** 처리 완료, 15분 45초 소요
- 1 Run = 10 batches = ~157분 = **2시간 37분**

### ldm_ffhq.sh / ldm_imagenet.sh 예상 시간 (A100 80GB 기준)

| Task | num_runs | Batches | 시간/Run | 총 시간 |
|------|----------|---------|----------|---------|
| phase_retrieval | 4 | 10 | ~2.6h | **~10.6h** |
| nonlinear_blur  | 1 | 10 | ~2.6h | ~2.6h |
| hdr             | 1 | 10 | ~2.6h | ~2.6h |
| down_sampling   | 1 | 10 | ~2.6h | ~2.6h |
| gaussian_blur   | 1 | 10 | ~2.6h | ~2.6h |
| motion_blur     | 1 | 10 | ~2.6h | ~2.6h |
| inpainting      | 1 | 10 | ~2.6h | ~2.6h |
| inpainting_rand | 1 | 10 | ~2.6h | ~2.6h |
| **Total**       |   |    |       | **~29h** |

### 전체 실행 시간
- `ldm_ffhq.sh`: ~29시간
- `ldm_imagenet.sh`: ~29시간
- **총: ~58시간 (2.4일)**

### 실행 명령어
```bash
cd ~/project_resample_daps/DAPS
conda activate Integrated_LDM

# 직렬 실행 (권장 - GPU util 100%일 때)
bash commands/ldm_ffhq.sh && touch ldm_ffhq_done.txt && bash commands/ldm_imagenet.sh && touch ldm_imagenet_done.txt
```

### 설정 참고
- `batch_size=10`: 한 번에 10장 GPU에 올려서 병렬 처리
- `annealing_scheduler_config.num_steps=50`: DAPS annealing steps
- `diffusion_scheduler_config.num_steps=2`: diffusion ODE steps
- test dataset: 100장 (FFHQ, ImageNet 각각)

### README vs 실제 차이
- README demo: 10장, DAPS-1k (200 annealing × 5 diffusion), ~8분/4runs
- 현재 test: 100장, DAPS-100 (50 annealing × 2 diffusion), ~10.6h/4runs for phase_retrieval

## GPU 사용량 (A100 80GB)
- 단일 sh 실행 시: ~29GB VRAM, GPU util 100%
- 병렬 실행 이점 없음 (GPU util이 이미 100%이므로)

<!-- ## 실험 일지 -->
<!-- 
**끄기 전에 결과 전부 다운받을 것**

- 12/08 12am: LDM FFHQ phase_retrieval 6시간 돌아감
  - A100: 10시간 동안 4시간 마저 돌리고 껐음

FFHQ 가벼운거 2개 nonlinear_blur, hdr
**다른데서 돌려줘야함! 8am에 3번에다 nonlinear_blur 2개 돌리면 예상 1pm, 최대 2:30pm에 끝날거라봄. 12:30pm에 1번에다 ffhq_hdr 돌리면 3pm쯤 끝날듯.**
**그럼 빠르면 1pm에 3번먼저 1개 비고, 3pm엔 웬만하면 3개 GPU 다 비어있을듯.**
sleep 2h && CUDA_VISIBLE_DEVICES=2 bash commands/yujin/l40s_3_additional.sh
sleep 6h && CUDA_VISIBLE_DEVICES=0 bash commands/yujin/l40s_1_additional.sh
둘다 실행해둠 6:24am에. 내가 잠들어서 한도 끊겨서 brev 사라질까봐 sleep 9h && zip -r ldm.zip ldm/ && b2 upload-file yuzzznk ldm.zip ldm.zip 도 해둠. 6:29am에.

- 12/08 1am: 다음의 4개 돌림. 11:45am쯤 끝날듯 **얘는 stop 옵션 있음. 단 혹시모르니 그 전에 결과 전부 다운받을 것**
  - L40S (1): FFHQ 가벼운거 4개 - down_sampling, gausian_blur, *motion_blur*, inpainting 
    *생각보다 빠르다 - down_sampling만 10분 걸렸음. gaussian_blur는 예상대로. motion_blur은 run당 20분. 이대로면 예정대로 12pm에 끝날듯*
  - L40S (2): ImageNet *phase_retrieval* 10.6시간
    *이놈만 엄청 오래걸림.. 26m/run... 총 26min x 10batch x 4run = 1040min 걸릴거같은데 정확히 6:20pm에 끝날듯*
  - L40S (3):
    FFHQ 가벼운거 1개 - inpainting_rand: run당 15분
    ImageNet 가벼운거 3개 - nonlinear_blur, hdr, *down_sampling* 
    *엥 nonlinear_blur 다운누락 이슈로 안돌아가 있었음! down_sampling 10분컷이니까 8am에 다 끝나있을듯*
  - L40S (4): ImageNet 가벼운거 3개 - gausian_blur, *motion_blur*, inpainting, inpainting_rand
    *생각보다 느리다 - gausian_blur는 예상대로였는데 motion_blur는 run당 20분! 2:30pm에 끝날듯*

- 12/08 3~4pm:
  - [GPU2]에선 imagenet_phase_retrieval이 잘 돌아가는 중. 6:25pm 끝날 듯
  - [GPU3,4] nonlinear_blur 안돌아가있길래 하나씩 돌림. 근데 미친 얘는 33min 걸림..............ㅋㅋㅋㅋㅋㅋㅋ 33min * 10batch => 8:30pm 나오는데?
  - [GPU1] 여기서 test 해봤으며, 4pm인 지금부터 imagenet의 phase retrieval을 돌리겠음. 걍 combined_imagenet 돌리면 저거부터 쭈루룩 실행될듯.

- 12/08 6:30pm:
  - [CUDA1] CUDA_VISIBLE_DEVICES=1 bash commands/combined/combined_ffhq_gpu1.sh 돌릴 것 -->

## Combined ver. 실험 계획

<!-- **디버깅하느라 시간 필요하면 결과데이터만 업로드 해두고 4GPU는 stop이라도 해둘 것!** -->

<!-- 월4PM~화9AM / 17시간 / [CUDA0]
- ImageNet의 무거운 task(phase_retrieval)를 돌려둠. 1040분 = 17.3시간 소요될 것으로 예상했으며 월7PM 분석결과 17시간 또는 그 이내로 끝날 듯. (13분 x 20iter x 4runs = 1040분) -->
<!-- 
월6:30PM~화11:30AM / 17시간 / [CUDA1]
- FFHQ의 무거운 task(phase_retrieval)를 돌려둠. 1040분 = 17.3시간 소요될 것으로 예상했으며 월7PM 분석결과 17시간 또는 그 이내로 끝날 듯. *metric은 재계산 필요, 아래에 스크립트 적어둠* -->

<!-- ~화2AM / 5.5시간 / [CUDA2,3]
- FFHQ, ImageNet nonlinear deblur 돌린 뒤 표 채움. 
- nonlinear blur는 ffhq/imagenet 무관 iter당 16.3분 걸렸다. -->

<!-- 화3AM~화7PM / 16시간 / [CUDA2] [CUDA3]
- FFHQ, ImageNet에 대해 HDR + linear를 각각 돌려둠.
  HDR은 iter당 8분 걸려서 총 2시간 40분 걸릴 듯! 쭉 이런식이라면 8분 * 20iter * 6run = 960분 = 16시간 소요될 것으로 예상됨.
  화11AM 기준 linear 5개 중 3번째인 motion_blur 하는중. 이거 끝나면 inpainting, inpainting_rand 2가지가 남는다.
  gaussian_blur는 iter당 7분, motion_blur는 iter당 10분 걸림.
- 화11:30AM, [CUDA0]에 ImageNet inpainting_rand -> ImageNet inpainting 돌리고
             [CUDA1]에 FFHQ inpainting_rand -> FFHQ inpainting 돌려둠
             inpainting_rand은 iter당 7분 x 20iter x 1run = 140분 = 2시간 20분 소요로 화2PM에 끝날 듯
             inpainting은 화2PM에 시작할 듯 화3:30PM에 끝나 있음
- 화1:30PM에 [CUDA2/CUDA3] motion_blur 끝나고 inpainting 시작한 뒤 inpainting_rand 순서로 돌아갈 것. 요건 화3:30PM에 걍 끄겠음.
- 그럼 inpainting은 걍 [CUDA2/3] 기준으로 끝나는거 체크하면 됨. 이게 마지막 HMC+ReSample5 실험이 될 것! 사실 근데 [CUDA0/1]이 더 빨리 끝나있으니 metric.json 만들어진거만 확인하고 끄겠음.
- 화3:30PM 정도에 stop/b2 다운로드/깃 업로드 해둠        -->

- 사실 또다른 optimization 세팅을 가지고 {(nonlinear_blur, hdr 총 8시간) x (ffhq, imagenet 2종)} 실험을 해볼 수도 있다. 아니면 데이터셋 한종류만 패서 두가지 세팅을 추가실험해봐도 되고! 특히 hdr는 nonlinear task 중 유일하게 timing 정보 소실이 없는 세팅이므로 hdr_ffhq만 패면서 여러 세팅을 탐혐해보는것도 가능은 할것이다 다만 hyperparameter tuning 이상의 의미가 없을거같으니 요건 걍 ablation의 일종으로만 둬야 할 듯..? *일단 모든건 hdr 수치까지 그리고 나오는 linear 수치까지 보고 결정하자.*
- 할거면 ULE (Langevin) + ReSample 5 세팅으로 돌려보자. 저렴한 GPU로 옮겨가서 오랜 시간 동안 냅두고!

### HMC + ReSample 15
- ImageNet HDR이 LatentDAPS만 못했으므로 걔에 대해 돌려보겠음. ImageNet phase retrieval에 대해서도. Gaussian도.
  L40S 1대로 돌릴거고, hdr랑 Gaussian 2.5시간, phase retrieval에 17시간 총 22시간 걸릴 듯.수6PM 정도에 끝난다고 보면됨

### HMC/ULA + Vanilla ReSample for Phase Retrieval

일단 로깅 겁나 때려놓고 0to1 돌리고 그다음 확인되면 1to10 돌려서 방향잡고 그다음에 10to90 돌려보자




---

### combined/imagenet/nonlinear_blur, combined/ffhq/nonlinear_blur sample은 돼있으나 이후에 timing 관련 에러 뜸.
### combined/imagenet/phase_retrieval, combined/ffhq/phase_retrieval 역시 sample은 돼있으나 이후에 timing 관련 에러가 뜰 예정
### 둘다 metric만 재계산하는 스크립트 돌려줬으나 timing 정보는 소실됨




**만약 GPU 1개만 써야하는 경우, *git push와 DAPS/results b2 업로드 확인하고* 다른 저렴한 곳으로 옮겨가도 될듯.**
**근데 보니까 가벼운 애들을 무거운거끝난 GPU로 1~2개씩 옮겨서 돌리게 될 것 같음.**

### 실험 예상 비용 

월7AM 기준, 화9AM까지면 5.84달러*1.3*26시간 = 197.4달러 = 29만원 ... 1.3배 없으면 22.3만원.

## 실험 결과 정리

*LDM FFHQ phase_retrieval*
100%|█████████████████████████████████████████████████████████████████| 50/50 [15:46<00:00, 18.93s/it, x0hat_psnr=18.26, x0y_psnr=18.35]

| 33.225 | 0.903 | 0.114 |
| 31.531 | 0.865 | 0.191 |
| 33.981 | 0.895 | 0.179 |
| 26.667 | 0.791 | 0.214 |
| 28.102 | 0.822 | 0.219 |
| 32.918 | 0.897 | 0.154 |
| 30.687 | 0.865 | 0.116 |
| 31.237 | 0.910 | 0.119 |
| 32.518 | 0.874 | 0.157 |
| 31.655 | 0.896 | 0.125 |
| 22.065 | 0.770 | 0.239 |
| 32.510 | 0.935 | 0.073 |
| 31.885 | 0.912 | 0.091 |
| 31.944 | 0.876 | 0.185 |
| 30.243 | 0.809 | 0.238 |
| 31.617 | 0.823 | 0.253 |
| 33.917 | 0.908 | 0.134 |
| 30.609 | 0.899 | 0.157 |
| 32.763 | 0.903 | 0.153 |
| 21.071 | 0.734 | 0.274 |
| 31.216 | 0.900 | 0.117 |
| 31.041 | 0.824 | 0.247 |
| 32.365 | 0.916 | 0.089 |
| 30.520 | 0.801 | 0.207 |
| 31.427 | 0.830 | 0.223 |
| 27.755 | 0.821 | 0.155 |
| 31.356 | 0.879 | 0.173 |
| 32.974 | 0.932 | 0.112 |
| 32.036 | 0.898 | 0.142 |
| 32.936 | 0.887 | 0.149 |
| 30.999 | 0.832 | 0.200 |
| 30.783 | 0.884 | 0.128 |
| 8.899  | 0.156 | 0.663 |
| 32.970 | 0.940 | 0.069 |
| 34.677 | 0.930 | 0.169 |
| 33.248 | 0.913 | 0.121 |
| 14.199 | 0.568 | 0.431 |
| 30.078 | 0.794 | 0.192 |
| 30.863 | 0.900 | 0.126 |
| 32.598 | 0.871 | 0.207 |
| 31.543 | 0.853 | 0.218 |
| 33.319 | 0.900 | 0.130 |
|        |       |       |
|  mean  |  mean |  mean |
| 30.126 | 0.839 | 0.192 |
|        |       |       |
|  std   |  std  |  std  |
| 4.822  | 0.118 | 0.100 |
finish phase_retrieval!



100%|█| 50/50 [15:12<00:00, 18.26s/it, x0hat_psnr=25.23, x0y_psnr=25.56
|        results         |
|--------|-------|-------|
|  psnr  |  ssim | lpips |
|--------|-------|-------|
| 22.925 | 0.792 | 0.294 |
| 24.847 | 0.848 | 0.201 |
| 23.918 | 0.739 | 0.192 |
| 26.723 | 0.851 | 0.264 |
| 26.874 | 0.838 | 0.212 |
| 20.748 | 0.647 | 0.342 |
| 27.597 | 0.837 | 0.156 |
| 22.653 | 0.659 | 0.339 |
| 29.286 | 0.895 | 0.118 |
| 30.541 | 0.872 | 0.160 |
| 26.219 | 0.847 | 0.247 |
| 28.903 | 0.896 | 0.267 |
| 26.769 | 0.876 | 0.158 |
| 29.001 | 0.895 | 0.160 |
| 25.575 | 0.902 | 0.163 |
| 31.346 | 0.925 | 0.184 |
| 29.874 | 0.907 | 0.136 |
| 30.489 | 0.896 | 0.109 |
| 29.758 | 0.877 | 0.122 |
| 27.667 | 0.925 | 0.120 |
| 30.911 | 0.895 | 0.154 |
| 28.835 | 0.917 | 0.188 |
| 23.272 | 0.798 | 0.221 |
| 31.798 | 0.918 | 0.158 |
| 27.169 | 0.884 | 0.187 |
| 31.603 | 0.917 | 0.104 |
| 25.000 | 0.840 | 0.251 |
| 25.275 | 0.754 | 0.270 |
| 26.440 | 0.744 | 0.232 |
| 26.732 | 0.848 | 0.235 |
| 28.464 | 0.862 | 0.191 |
| 27.605 | 0.874 | 0.221 |
| 21.163 | 0.659 | 0.357 |
| 28.513 | 0.894 | 0.150 |
| 23.151 | 0.744 | 0.516 |
| 20.635 | 0.665 | 0.343 |
| 33.017 | 0.931 | 0.114 |
| 28.237 | 0.722 | 0.228 |
| 29.795 | 0.919 | 0.122 |
| 27.565 | 0.887 | 0.153 |
| 26.632 | 0.845 | 0.211 |
| 31.083 | 0.908 | 0.165 |
| 27.045 | 0.891 | 0.213 |
| 27.036 | 0.861 | 0.216 |
| 22.849 | 0.701 | 0.347 |
| 31.827 | 0.923 | 0.157 |
| 26.567 | 0.894 | 0.160 |
| 32.625 | 0.908 | 0.135 |
| 25.578 | 0.848 | 0.244 |
| 29.578 | 0.893 | 0.146 |
| 22.591 | 0.772 | 0.246 |
| 24.351 | 0.733 | 0.299 |
| 25.059 | 0.826 | 0.262 |
| 25.587 | 0.920 | 0.156 |
| 30.430 | 0.885 | 0.157 |
| 26.029 | 0.846 | 0.215 |
| 24.794 | 0.831 | 0.220 |
| 24.499 | 0.824 | 0.173 |
| 33.990 | 0.926 | 0.118 |
| 33.903 | 0.917 | 0.141 |
| 26.235 | 0.866 | 0.261 |
| 26.835 | 0.843 | 0.254 |
| 29.044 | 0.884 | 0.155 |
| 26.421 | 0.861 | 0.248 |
| 28.996 | 0.858 | 0.096 |
| 26.559 | 0.916 | 0.123 |
| 17.397 | 0.490 | 0.398 |
| 26.863 | 0.909 | 0.154 |
| 29.266 | 0.879 | 0.169 |
| 30.066 | 0.927 | 0.082 |
| 26.862 | 0.885 | 0.144 |
| 26.102 | 0.757 | 0.265 |
| 30.551 | 0.875 | 0.197 |
| 27.072 | 0.787 | 0.341 |
| 28.826 | 0.907 | 0.162 |
| 25.763 | 0.857 | 0.192 |
| 27.131 | 0.851 | 0.217 |
| 24.458 | 0.856 | 0.165 |
| 25.799 | 0.860 | 0.170 |
| 23.335 | 0.754 | 0.348 |
| 28.506 | 0.910 | 0.112 |
| 31.492 | 0.875 | 0.138 |
| 32.266 | 0.903 | 0.165 |
| 30.101 | 0.903 | 0.121 |
| 26.917 | 0.893 | 0.168 |
| 32.517 | 0.942 | 0.116 |
| 30.519 | 0.907 | 0.147 |
| 29.397 | 0.908 | 0.153 |
| 23.741 | 0.678 | 0.373 |
| 25.813 | 0.770 | 0.215 |
| 17.584 | 0.585 | 0.273 |
| 23.676 | 0.846 | 0.130 |
| 22.713 | 0.831 | 0.282 |
| 28.396 | 0.905 | 0.176 |
| 28.319 | 0.912 | 0.126 |
| 19.604 | 0.605 | 0.444 |
| 27.787 | 0.899 | 0.136 |
| 28.952 | 0.903 | 0.205 |
| 25.984 | 0.847 | 0.218 |
| 32.560 | 0.907 | 0.120 |
|        |       |       |
|  mean  |  mean |  mean |
| 27.194 | 0.845 | 0.203 |
|        |       |       |
|  std   |  std  |  std  |
| 3.353  | 0.086 | 0.080 |
finish hdr!
L40S (1) FFHQ hdr tasks done!

██████████████████████████████████████████████████████████████████████████████████████████| 50/50 [25:44<00:00, 30.90s/it, x0hat_psnr=16.91, x0y_psnr=16.89]
|        results         |
|--------|-------|-------|
|  psnr  |  ssim | lpips |
|--------|-------|-------|
| 19.856 | 0.752 | 0.367 |
| 17.440 | 0.457 | 0.569 |
| 29.058 | 0.882 | 0.241 |
| 15.888 | 0.455 | 0.667 |
| 16.572 | 0.318 | 0.566 |
| 25.673 | 0.712 | 0.439 |
| 25.755 | 0.822 | 0.420 |
| 26.885 | 0.696 | 0.336 |
| 9.801  | 0.217 | 0.602 |
| 34.411 | 0.938 | 0.146 |
| 17.792 | 0.318 | 0.385 |
| 30.966 | 0.860 | 0.234 |
| 21.752 | 0.829 | 0.309 |
| 24.798 | 0.577 | 0.433 |
| 8.068  | 0.443 | 0.524 |
| 14.157 | 0.380 | 0.646 |
| 13.059 | 0.379 | 0.671 |
| 16.177 | 0.291 | 0.488 |
| 17.489 | 0.365 | 0.526 |
| 15.407 | 0.304 | 0.570 |
| 16.629 | 0.314 | 0.561 |
| 20.380 | 0.650 | 0.438 |
| 15.740 | 0.238 | 0.553 |
| 12.799 | 0.138 | 0.634 |
| 15.545 | 0.262 | 0.522 |
| 33.240 | 0.930 | 0.113 |
| 23.358 | 0.790 | 0.154 |
| 14.724 | 0.492 | 0.647 |
| 29.594 | 0.842 | 0.223 |
| 12.784 | 0.185 | 0.692 |
| 14.922 | 0.290 | 0.572 |
| 20.039 | 0.615 | 0.264 |
| 15.210 | 0.319 | 0.585 |
| 13.317 | 0.350 | 0.486 |
| 11.880 | 0.159 | 0.694 |
| 12.958 | 0.238 | 0.632 |
| 28.802 | 0.733 | 0.316 |
| 12.807 | 0.219 | 0.576 |
| 12.428 | 0.356 | 0.687 |
| 12.856 | 0.243 | 0.606 |
| 16.093 | 0.242 | 0.601 |
| 15.124 | 0.540 | 0.481 |
| 15.397 | 0.406 | 0.541 |
| 12.894 | 0.127 | 0.601 |
| 16.066 | 0.339 | 0.552 |
| 17.826 | 0.480 | 0.373 |
| 27.808 | 0.706 | 0.369 |
| 12.828 | 0.219 | 0.676 |
| 23.973 | 0.781 | 0.390 |
| 15.748 | 0.414 | 0.649 |
| 11.087 | 0.190 | 0.708 |
| 27.911 | 0.832 | 0.159 |
| 15.419 | 0.095 | 0.557 |
| 11.654 | 0.097 | 0.647 |
| 13.223 | 0.244 | 0.552 |
| 26.140 | 0.750 | 0.330 |
| 16.627 | 0.270 | 0.528 |
| 8.027  | 0.113 | 0.728 |
| 17.811 | 0.365 | 0.599 |
| 25.338 | 0.678 | 0.358 |
| 19.115 | 0.515 | 0.483 |
| 29.533 | 0.885 | 0.132 |
| 25.878 | 0.753 | 0.298 |
| 28.211 | 0.766 | 0.297 |
| 15.335 | 0.578 | 0.574 |
| 13.439 | 0.109 | 0.582 |
| 7.983  | 0.338 | 0.740 |
| 12.508 | 0.209 | 0.493 |
| 25.940 | 0.642 | 0.348 |
| 13.099 | 0.132 | 0.703 |
| 15.515 | 0.263 | 0.590 |
| 13.228 | 0.263 | 0.568 |
| 15.717 | 0.160 | 0.604 |
| 23.190 | 0.774 | 0.390 |
| 21.593 | 0.773 | 0.289 |
| 15.463 | 0.115 | 0.563 |
| 24.697 | 0.614 | 0.350 |
| 12.750 | 0.141 | 0.634 |
| 20.857 | 0.556 | 0.459 |
| 17.527 | 0.305 | 0.661 |
| 15.307 | 0.311 | 0.568 |
| 11.646 | 0.205 | 0.606 |
| 28.592 | 0.768 | 0.244 |
| 33.680 | 0.932 | 0.190 |
| 29.695 | 0.769 | 0.406 |
| 25.699 | 0.791 | 0.280 |
| 15.885 | 0.231 | 0.605 |
| 15.020 | 0.298 | 0.755 |
| 28.918 | 0.756 | 0.312 |
| 17.685 | 0.249 | 0.623 |
| 18.009 | 0.253 | 0.563 |
| 17.063 | 0.399 | 0.580 |
| 26.932 | 0.762 | 0.357 |
| 8.011  | 0.325 | 0.725 |
| 25.843 | 0.910 | 0.229 |
| 24.522 | 0.744 | 0.277 |
| 13.154 | 0.266 | 0.647 |
| 33.915 | 0.958 | 0.065 |
| 13.473 | 0.266 | 0.516 |
| 18.558 | 0.398 | 0.572 |
|        |       |       |
|  mean  |  mean |  mean |
| 18.912 | 0.467 | 0.484 |
|        |       |       |
|  std   |  std  |  std  |
| 6.648  | 0.257 | 0.167 |
finish phase_retrieval!
L40S (2) ImageNet phase_retrieval done!



100%|██████████████████████████████████████████████████████████████████████████| 50/50 [33:03<00:00, 39.68s/it, x0hat_psnr=29.85, x0y_psnr=30.23]

|        results         |
|--------|-------|-------|
|  psnr  |  ssim | lpips |
|--------|-------|-------|
| 30.045 | 0.837 | 0.256 |
| 26.396 | 0.828 | 0.196 |
| 25.939 | 0.783 | 0.158 |
| 29.867 | 0.873 | 0.199 |
| 29.678 | 0.848 | 0.180 |
| 26.976 | 0.783 | 0.233 |
| 30.204 | 0.846 | 0.181 |
| 30.034 | 0.752 | 0.278 |
| 31.119 | 0.875 | 0.131 |
| 29.736 | 0.831 | 0.211 |
| 28.604 | 0.799 | 0.246 |
| 31.394 | 0.894 | 0.201 |
| 28.643 | 0.857 | 0.161 |
| 28.107 | 0.783 | 0.244 |
| 29.182 | 0.825 | 0.199 |
| 31.478 | 0.891 | 0.207 |
| 32.013 | 0.896 | 0.167 |
| 31.101 | 0.861 | 0.147 |
| 27.939 | 0.729 | 0.298 |
| 31.060 | 0.920 | 0.105 |
| 28.042 | 0.811 | 0.238 |
| 33.499 | 0.902 | 0.126 |
| 28.598 | 0.778 | 0.288 |
| 32.336 | 0.874 | 0.190 |
| 29.448 | 0.830 | 0.231 |
| 29.583 | 0.818 | 0.193 |
| 32.604 | 0.884 | 0.169 |
| 27.067 | 0.770 | 0.239 |
| 29.642 | 0.857 | 0.176 |
| 29.315 | 0.838 | 0.226 |
| 29.229 | 0.807 | 0.239 |
| 32.946 | 0.891 | 0.174 |
| 28.257 | 0.783 | 0.261 |
| 30.983 | 0.878 | 0.158 |
| 32.187 | 0.864 | 0.269 |
| 27.890 | 0.782 | 0.250 |
| 29.679 | 0.840 | 0.190 |
| 33.972 | 0.896 | 0.211 |
| 32.702 | 0.886 | 0.175 |
| 29.145 | 0.861 | 0.182 |
| 28.767 | 0.825 | 0.218 |
| 29.839 | 0.854 | 0.209 |
| 32.066 | 0.894 | 0.180 |
| 29.525 | 0.879 | 0.180 |
| 30.492 | 0.803 | 0.307 |
| 31.241 | 0.895 | 0.179 |
| 28.962 | 0.858 | 0.186 |
| 30.206 | 0.820 | 0.229 |
| 30.554 | 0.844 | 0.218 |
| 30.136 | 0.826 | 0.210 |
| 31.038 | 0.871 | 0.138 |
| 29.199 | 0.813 | 0.278 |
| 31.578 | 0.914 | 0.163 |
| 32.321 | 0.909 | 0.126 |
| 30.644 | 0.819 | 0.259 |
| 26.940 | 0.777 | 0.250 |
| 31.266 | 0.913 | 0.137 |
| 24.256 | 0.791 | 0.155 |
| 32.450 | 0.891 | 0.140 |
| 28.900 | 0.827 | 0.251 |
| 33.188 | 0.907 | 0.173 |
| 29.000 | 0.819 | 0.233 |
| 27.957 | 0.819 | 0.215 |
| 32.061 | 0.889 | 0.171 |
| 28.486 | 0.796 | 0.193 |
| 27.157 | 0.839 | 0.175 |
| 31.535 | 0.873 | 0.185 |
| 30.322 | 0.853 | 0.185 |
| 28.412 | 0.778 | 0.227 |
| 29.942 | 0.889 | 0.116 |
| 30.711 | 0.889 | 0.115 |
| 29.689 | 0.834 | 0.231 |
| 30.590 | 0.826 | 0.232 |
| 30.897 | 0.824 | 0.273 |
| 33.286 | 0.906 | 0.142 |
| 28.526 | 0.859 | 0.176 |
| 31.525 | 0.896 | 0.166 |
| 28.676 | 0.893 | 0.129 |
| 29.439 | 0.871 | 0.135 |
| 29.604 | 0.804 | 0.282 |
| 29.862 | 0.885 | 0.132 |
| 29.958 | 0.793 | 0.222 |
| 31.044 | 0.837 | 0.217 |
| 29.183 | 0.833 | 0.195 |
| 30.288 | 0.871 | 0.180 |
| 30.079 | 0.888 | 0.160 |
| 30.712 | 0.873 | 0.166 |
| 32.476 | 0.893 | 0.169 |
| 30.253 | 0.829 | 0.215 |
| 29.233 | 0.846 | 0.201 |
| 28.941 | 0.747 | 0.195 |
| 30.801 | 0.919 | 0.082 |
| 31.492 | 0.892 | 0.223 |
| 28.272 | 0.864 | 0.182 |
| 29.249 | 0.883 | 0.144 |
| 30.270 | 0.821 | 0.178 |
| 28.956 | 0.847 | 0.184 |
| 31.954 | 0.871 | 0.217 |
| 30.388 | 0.846 | 0.226 |
| 31.929 | 0.886 | 0.154 |
|        |       |       |
|  mean  |  mean |  mean |
| 30.034 | 0.848 | 0.196 |
|        |       |       |
|  std   |  std  |  std  |
| 1.730  | 0.043 | 0.046 |
finish nonlinear_blur!
L40S (3) additional nonlinear deblur tasks done!













100%|███████████| 50/50 [33:10<00:00, 39.81s/it, x0hat_psnr=28.87, x0y_psnr=29.20]

|        results         |
|--------|-------|-------|
|  psnr  |  ssim | lpips |
|--------|-------|-------|
| 33.472 | 0.887 | 0.285 |
| 27.379 | 0.728 | 0.344 |
| 27.514 | 0.848 | 0.215 |
| 30.260 | 0.863 | 0.203 |
| 26.029 | 0.643 | 0.318 |
| 29.163 | 0.769 | 0.343 |
| 36.657 | 0.943 | 0.310 |
| 27.468 | 0.698 | 0.320 |
| 30.036 | 0.846 | 0.218 |
| 30.465 | 0.902 | 0.164 |
| 22.457 | 0.623 | 0.285 |
| 34.486 | 0.899 | 0.186 |
| 26.774 | 0.912 | 0.222 |
| 28.998 | 0.726 | 0.330 |
| 34.975 | 0.928 | 0.158 |
| 29.104 | 0.778 | 0.231 |
| 31.061 | 0.877 | 0.205 |
| 25.843 | 0.748 | 0.251 |
| 24.259 | 0.624 | 0.339 |
| 22.623 | 0.594 | 0.347 |
| 24.716 | 0.710 | 0.255 |
| 28.990 | 0.705 | 0.380 |
| 26.513 | 0.798 | 0.194 |
| 20.934 | 0.585 | 0.248 |
| 24.506 | 0.685 | 0.296 |
| 28.991 | 0.873 | 0.138 |
| 21.917 | 0.706 | 0.193 |
| 30.928 | 0.794 | 0.388 |
| 31.187 | 0.829 | 0.228 |
| 30.951 | 0.900 | 0.032 |
| 23.778 | 0.642 | 0.276 |
| 24.849 | 0.827 | 0.134 |
| 26.285 | 0.794 | 0.195 |
| 22.528 | 0.875 | 0.131 |
| 24.075 | 0.754 | 0.178 |
| 26.968 | 0.705 | 0.272 |
| 28.624 | 0.711 | 0.321 |
| 24.243 | 0.679 | 0.217 |
| 30.066 | 0.855 | 0.195 |
| 25.666 | 0.765 | 0.257 |
| 24.802 | 0.600 | 0.316 |
| 28.441 | 0.880 | 0.159 |
| 30.206 | 0.901 | 0.186 |
| 21.562 | 0.583 | 0.330 |
| 26.577 | 0.639 | 0.273 |
| 25.789 | 0.701 | 0.216 |
| 27.634 | 0.708 | 0.357 |
| 24.224 | 0.538 | 0.373 |
| 34.084 | 0.918 | 0.202 |
| 26.930 | 0.845 | 0.183 |
| 24.528 | 0.800 | 0.178 |
| 26.164 | 0.802 | 0.159 |
| 20.416 | 0.462 | 0.399 |
| 20.620 | 0.604 | 0.214 |
| 24.554 | 0.870 | 0.187 |
| 27.175 | 0.772 | 0.292 |
| 23.513 | 0.646 | 0.315 |
| 26.546 | 0.863 | 0.101 |
| 28.717 | 0.777 | 0.295 |
| 27.119 | 0.693 | 0.333 |
| 21.572 | 0.653 | 0.323 |
| 27.772 | 0.867 | 0.134 |
| 30.559 | 0.800 | 0.263 |
| 27.479 | 0.763 | 0.287 |
| 28.137 | 0.833 | 0.269 |
| 19.691 | 0.480 | 0.253 |
| 25.525 | 0.674 | 0.302 |
| 26.331 | 0.716 | 0.256 |
| 27.141 | 0.647 | 0.332 |
| 23.991 | 0.617 | 0.336 |
| 25.071 | 0.742 | 0.229 |
| 26.499 | 0.795 | 0.176 |
| 23.588 | 0.586 | 0.316 |
| 29.360 | 0.864 | 0.238 |
| 31.776 | 0.921 | 0.187 |
| 17.543 | 0.421 | 0.391 |
| 25.812 | 0.635 | 0.284 |
| 24.249 | 0.545 | 0.275 |
| 27.925 | 0.816 | 0.218 |
| 26.069 | 0.641 | 0.321 |
| 27.000 | 0.723 | 0.230 |
| 23.578 | 0.596 | 0.385 |
| 28.755 | 0.768 | 0.227 |
| 35.270 | 0.941 | 0.153 |
| 31.057 | 0.808 | 0.325 |
| 28.019 | 0.836 | 0.222 |
| 23.880 | 0.576 | 0.316 |
| 28.679 | 0.796 | 0.168 |
| 30.139 | 0.775 | 0.286 |
| 23.582 | 0.509 | 0.371 |
| 24.306 | 0.635 | 0.279 |
| 30.648 | 0.778 | 0.255 |
| 28.243 | 0.780 | 0.317 |
| 32.805 | 0.903 | 0.184 |
| 37.285 | 0.978 | 0.183 |
| 27.912 | 0.813 | 0.189 |
| 24.319 | 0.747 | 0.230 |
| 34.280 | 0.960 | 0.055 |
| 22.924 | 0.664 | 0.325 |
| 29.310 | 0.783 | 0.265 |
|        |       |       |
|  mean  |  mean |  mean |
| 27.134 | 0.750 | 0.252 |
|        |       |       |
|  std   |  std  |  std  |
| 3.759  | 0.121 | 0.076 |
finish nonlinear_blur!
L40S (4) additional nonlinear deblur tasks done!